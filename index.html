<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viral Cascade: AI Edition</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Viral Cascade: AI Edition</h1>
        <button id="menu-button">☰</button>
    </header>
    
    <div class="game-container" id="game-view" style="display:none;">
        <div class="level-info">
            <div>
                <div class="level-title" id="level-title">Level 1: Classification Basics</div>
                <div class="level-description" id="level-description">Train your first neural network to classify simple binary patterns.</div>
            </div>
            <div class="metrics">
                <div class="metric">
                    <div class="metric-label">Accuracy</div>
                    <div class="metric-value" id="accuracy-value">0%</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Loss</div>
                    <div class="metric-value" id="loss-value">0.00</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Epoch</div>
                    <div class="metric-value" id="epoch-value">0</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Tokens</div>
                    <div class="metric-value" id="tokens-value">10</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Target</div>
                    <div class="metric-value" id="target-value">85%</div>
                </div>
            </div>
        </div>
        
        <div class="network-container">
            <canvas class="network-canvas" id="network-canvas"></canvas>
            <div class="tokens-container">
                <button id="training-token">Deploy Training Token</button>
            </div>
            <div class="power-up-container" id="power-up-container">
                <!-- Power-ups will be added dynamically -->
            </div>
            <button class="toggle-stats" id="toggle-stats">Show Stats</button>
            <div class="stats-panel" id="stats-panel">
                <div class="stats-title">Training Statistics</div>
                <div class="stats-value">
                    <span>Learning Rate:</span>
                    <span id="stat-learning-rate">0.5</span>
                </div>
                <div class="stats-value">
                    <span>Batch Size:</span>
                    <span id="stat-batch-size">32</span>
                </div>
                <div class="stats-value">
                    <span>Gradient Norm:</span>
                    <span id="stat-gradient">0.00</span>
                </div>
                <div class="stats-value">
                    <span>Weight Avg:</span>
                    <span id="stat-weight-avg">0.00</span>
                </div>
                <div class="chart-container">
                    <canvas id="accuracy-chart"></canvas>
                    <div class="chart-label">Accuracy Over Time</div>
                </div>
            </div>
            <div class="tooltip" id="tooltip"></div>
        </div>
        
        <div class="control-panel">
            <div class="parameter-controls" id="parameter-controls">
                <!-- Parameters will be added dynamically based on level -->
            </div>
            <div class="action-controls">
                <button id="reset-button">Reset Network</button>
                <button id="train-button">Run Training</button>
            </div>
        </div>

        <div class="concept-popup" id="concept-popup">
            <button class="close-concept" id="close-concept">×</button>
            <h3 class="concept-title" id="concept-title">Concept Title</h3>
            <div class="concept-content" id="concept-content">
                Concept explanation will appear here.
            </div>
        </div>
    </div>
    
    <div class="overlay" id="level-select-overlay">
        <div class="card" style="width: 80%; max-width: 1000px;">
            <h3 class="card-title">Select a Level</h3>
            <div class="level-select-container" id="level-select-container">
                <!-- Level cards will be added dynamically -->
            </div>
            <!-- Fallback button in case dynamic loading fails -->
            <div style="text-align: center; margin-top: 20px;">
                <button id="start-level-1-btn" style="padding: 10px 20px; background-color: #4fc3f7; border: none; border-radius: 4px; color: #121218; font-weight: bold; cursor: pointer;">
                    Start Level 1
                </button>
            </div>
        </div>
    </div>
    
    <div class="overlay" id="tutorial-overlay" style="display:none;">
        <div class="card">
            <h3 class="card-title" id="tutorial-title">Welcome to Viral Cascade: AI Edition</h3>
            <div class="card-content" id="tutorial-content">
                In this game, you're a neural network trainer. Your goal is to adjust weights and parameters to achieve the target accuracy for each level.
                <br><br>
                <strong>How to play:</strong>
                <br>
                1. Deploy training tokens on nodes to influence them
                <br>
                2. Adjust parameters like learning rate and activation threshold
                <br>
                3. Run training to see how your network performs
                <br>
                4. Achieve the target accuracy to complete the level
            </div>
            <button class="card-button" id="tutorial-next">Start Training</button>
        </div>
    </div>

    <div class="overlay" id="level-complete-overlay" style="display:none;">
        <div class="card">
            <h3 class="card-title">Level Complete!</h3>
            <div class="card-content" id="level-complete-content">
                Congratulations! You've successfully trained your neural network to achieve the target accuracy.
                <br><br>
                <strong>Rewards:</strong>
                <br>
                <div id="rewards-list">
                    <!-- Rewards will be added dynamically -->
                </div>
            </div>
            <button class="card-button" id="level-complete-next">Next Level</button>
        </div>
    </div>

    <!-- Load Scripts -->
    <script src="models.js"></script>
    <script src="network.js"></script>
    <script src="ui.js"></script>
    <script src="game.js"></script>
</body>
</html>